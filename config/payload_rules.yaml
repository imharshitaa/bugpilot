# payload_rules.yaml
# Defines safe payloads used by modules for detection logic.

xss:
  payloads:
    - "<xss_test>"
    - "\"><xss_test>"
  apply_to_methods: ["GET", "POST"]
  match_indicators:
    - "<xss_test>"

sqli:
  payloads:
    - "'"
    - "\""
    - "' OR '1'='1"
  error_signatures:
    - "SQL syntax"
    - "database error"
    - "mysql"
    - "syntax error"
    - "unexpected error"

ssrf:
  payloads:
    - "http://localhost"
    - "http://127.0.0.1"
    - "http://169.254.169.254"   # AWS metadata (safe indicator only)
  match_indicators:
    - "Connection refused"
    - "refused"
    - "Internal Server Error"

auth_bypass:
  unauth_indicators:
    - "200 OK"
    - "Welcome admin"
    - "Dashboard"
    - "User: admin"

misconfig:
  headers_to_check:
    - "X-Frame-Options"
    - "X-Content-Type-Options"
    - "Strict-Transport-Security"
    - "Content-Security-Policy"
    - "Access-Control-Allow-Origin"

rate_limit_bruteforce:
  burst_count: 8
  success_statuses: [200, 201, 202, 204]

jwt_validation_weaknesses:
  indicators:
    - "eyJ"
    - "jwt"
  weak_algorithms:
    - "none"

insecure_deserialization:
  payload_markers:
    - "O:8:\"stdClass\":0:{}"
    - "rO0ABXQ="
    - "gASV"
  error_signatures:
    - "unserialize()"
    - "invalidclass"
    - "pickle"
    - "java.io"

business_logic_abuse:
  tamper_params:
    price: "-1"
    amount: "0"
    quantity: "-5"
  success_statuses: [200, 201, 202, 204]

graphql_specific_testing:
  introspection_query: '{"query":"{__schema{types{name}}}"}'
  indicators:
    - "__schema"
    - "graphql"

file_upload_testing:
  indicators:
    - "multipart/form-data"
    - "upload"
    - "file"

xxe:
  payload: '<?xml version="1.0"?><!DOCTYPE root [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><root>&xxe;</root>'
  error_signatures:
    - "xml parser"
    - "external entity"
    - "doctype is disallowed"
